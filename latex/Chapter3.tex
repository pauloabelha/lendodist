\documentclass[12pt]{article}
 \usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{mathtools,amssymb}
\usepackage{color}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
 
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
%If you want to title your bold things something different just make another thing exactly like this but replace "problem" with the name of the thing you want, like theorem or lemma or whatever

\begin{document}
 
%\renewcommand{\qedsymbol}{\filledbox}
%Good resources for looking up how to do stuff:
%Binary operators: http://www.access2science.com/latex/Binary.html
%General help: http://en.wikibooks.org/wiki/LaTeX/Mathematics
%Or just google stuff

\definecolor{blogger-black}{rgb}{0.1025,0.1025,0.1025}
\pagecolor{blogger-black}
\color{white} 
 
\title{Slaying the Mythical p}
\author{Paulo Abelha}
\maketitle
<<<<<<< HEAD

Binomial distribution:
=======

Binomial distribution:

\begin{gather}
P(F_h | p_h, F) = \binom{F}{F_h}p_h^{F_h}(1-p_h)^{F-F_h}
\end{gather}

Statistician:

\begin{gather}
F = 250, F_h = 140, p_h = 0.5, F-F_h = F_t = 110
\end{gather}

\begin{gather}
P(F_h = 140 | p_h =0.5, N=250) = \binom{250}{140}0.5^{140}(1-0.5)^{110} \simeq 10^{-21}
\end{gather}
>>>>>>> 6591c5f9dd549b58da4dc6a796acf177ec01b115

\begin{gather}
P(F_h | p_h, F) = \binom{F}{F_h}p_h^{F_h}(1-p_h)^{F-F_h}
\end{gather}

Statistician:

\begin{gather}
F = 250, F_h = 140, p_h = \frac{1}{2}, F-F_h = F_t = 110
\end{gather}

\begin{gather}
P(F_h = 140 | p_h =\frac{1}{2}, F=250) = \binom{250}{140}\Big(\frac{1}{2}\Big)^{140}\Big(1-\frac{1}{2}\Big)^{110} \simeq 10^{-21}
\end{gather}

\begin{gather}
P(F_h \geq 140 | p_h, F) = \sum_{F_h=140}^{250} \binom{250}{F_h}\Big(\frac{1}{2}\Big)^{F_h}\Big(1-\frac{1}{2}\Big)^{F-F_h}
\end{gather}

\begin{gather}
P(F_h \geq 140 | p_h, F) = \Big(\frac{1}{2}\Big)^{250} \sum_{F_h=140}^{250} \binom{250}{F_h}
\end{gather}

\begin{gather}
P(F_h \geq 140 | p_h, F) \simeq 0.0332
\end{gather}

$\mathcal{H}_0$ : Coin is fair

$\mathcal{H}_1$ : Coin is biased

$D$ : Data of 140 heads in 250 spins

$F_h$ :  140 (frequency of heads)

$F_t$ :  110 (frequency of tails)

$F$ : 250 (number of coin spins)

$p_h$ : Probability of heads

Getting model comparison:

\begin{gather}
P(\mathcal{H}_0 | D) = \frac{P(D | \mathcal{H}_0)P(\mathcal{H}_0)}{P(D)}
\end{gather}

\begin{gather}
P(\mathcal{H}_1 | D) = \frac{P(D | \mathcal{H}_1)P(\mathcal{H}_1)}{P(D)}
\end{gather}

\begin{gather}
P(\mathcal{H}_0) = P(\mathcal{H}_1) = \frac{1}{2}
\end{gather}

\begin{gather}
\frac{P(\mathcal{H}_1 | D)}{P(\mathcal{H}_0 | D)} = \frac{P(D | \mathcal{H}_1)}{P(D | \mathcal{H}_0)}
\end{gather}

Done getting model comparison.

Getting $P(D|\mathcal{H}_1)$ :

\begin{gather}
P(D|\mathcal{H}_1) = \int_0^1 \! \mathrm{d}p_h P(D|p_h,\mathcal{H}_1)P(p_h|\mathcal{H}_1)
\end{gather}

\begin{gather}
P(D|p_h,\mathcal{H}_1) = p_h^{F_h}(1 - p_h)^{F_t}
\end{gather}

\begin{gather}
P(p_h|\mathcal{H}_1) = 1
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \int_0^1 \! \mathrm{d}p_h p_h^{F_h}(1 - p_h)^{F_t}
\end{gather}

\begin{gather}
B(x,y) = \int_0^1 \! \mathrm{d}t t^{x-1}(1-t)^{y-1} = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = B(F_h+1,F_t+1) = \frac{\Gamma(F_h+1)\Gamma(F_t+1)}{\Gamma(F_h+F_t+2)}
\end{gather}

\begin{gather}
\Gamma(x) = (x-1)!
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \frac{(F_h+1)!(F_t+1)!}{(F_h+F_t+1)!} = \frac{F_h!F_t!}{(F+1)!}
\end{gather}

End of getting $P(D|\mathcal{H}_1)$.

Getting $P(D|\mathcal{H}_0)$ :

\begin{gather}
p_f = \frac{1}{2}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_0) = \Big(\frac{1}{2}\Big)^{F_h}\Big(1 - \Big(\frac{1}{2}\Big)\Big)^{F_t} = \Big(\frac{1}{2}\Big)^{F}
\end{gather}


Done getting $P(D|\mathcal{H}_0)$.

Computing model comparison:

\begin{gather}
\frac{P(\mathcal{H}_1 | D)}{P(\mathcal{H}_0 | D)} = \frac{\frac{F_h!F_t!}{(F+1)!}}{\Big(\frac{1}{2}\Big)^{F}} =  \frac{\frac{140!110!}{251!}}{\Big(\frac{1}{2}\Big)^{250}} \simeq 0.48
\end{gather}

End computing model comparison.

Getting Beta prior:

\begin{gather}
P(p_h|\mathcal{H}_1,\alpha) = \frac{1}{Z(\alpha)}   p_h^{\alpha-1}(1-p_h)^{\alpha-1}
\end{gather}

\begin{gather}
Z(\alpha) = \frac{\Gamma(\alpha)^2}{\Gamma(2\alpha)}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \int_0^1 \! \mathrm{d}p_h P(D|p_h,\mathcal{H}_1)P(p_h|\mathcal{H}_1)
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \int_0^1 \! \mathrm{d}p_h p_h^{F_h}(1 - p_h)^{F_t} \frac{1}{Z(\alpha)}   p_h^{\alpha-1}(1-p_h)^{\alpha-1}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \frac{1}{Z(\alpha)}   \int_0^1 \! \mathrm{d}p_h p_h^{F_h+\alpha-1}(1 - p_h)^{F_t+\alpha-1}
\end{gather}

\begin{gather}
B(F_h+\alpha-1+1,F_t+\alpha-1+1) = \frac{\Gamma(F_h+\alpha)\Gamma(F_t+\alpha)}{\Gamma(F+2\alpha)}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \frac{1}{Z(\alpha)} \frac{\Gamma(F_h+\alpha)\Gamma(F_t+\alpha)}{\Gamma(F+2\alpha)}
\end{gather}

\begin{gather}
P(D|\mathcal{H}_1) = \frac{\Gamma(2\alpha)\Gamma(F_h+\alpha)\Gamma(F_t+\alpha)}{\Gamma(\alpha)^2\Gamma(F+2\alpha)}
\end{gather}

\begin{gather}
\frac{P(\mathcal{H}_1 | D)}{P(\mathcal{H}_0 | D)} =
\frac{\Gamma(2\alpha)\Gamma(F_h+\alpha)\Gamma(F_t+\alpha)2^{250}}
{\Gamma(\alpha)^2\Gamma(F+2\alpha)}
\end{gather}

End getting Beta prior.
 
Getting best possible prior:
 
\begin{gather}
 \frac{P(\mathcal{H}_1 | D)}{P(\mathcal{H}_0 | D)} =
 f^{F_h}(1-f)^{F_t}2^F \simeq 6.1
\end{gather}



\end{document}
